"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_get=function e(t,i,r){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,i);if(void 0===s){var n=Object.getPrototypeOf(t);return null===n?void 0:e(n,i,r)}if("value"in s)return s.value;var a=s.get;if(void 0!==a)return a.call(r)};exports.udApi=function(e){function t(r){if(i[r])return i[r].exports;var s=i[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,r){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=14)}([function(e,t){e.exports=require("lodash")},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i(15))},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),s=i(1),n=function(e){function t(e){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.name="",i.help="",i.mandatory=!1,i.id=e,i}return _inherits(t,e),_createClass(t,[{key:"serialize",value:function(){var e=Object.assign({},_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this),{name:this.name,type:this.type(),mandatory:this.mandatory});return r.isEmpty(this.help)||(e.help=this.help),e}},{key:"deserialize",value:function(e){return _get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deserialize",this).call(this,e),r.isEmpty(e)?this:(this.name=e.name,this.help=e.help,this.mandatory=e.mandatory,this)}}]),t}(s.ValidableObject);t.Field=n},function(e,t,i){function r(e,t){switch(t){case"boolean":return new o.Boolean(e);default:return null}}function s(e,t){if(!n.isString(t.type))return null;var i=r(e,t.type);return n.isEmpty(i)||i.deserialize(t),i}Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),a=i(2);t.Field=a.Field;var o=i(11);t.Boolean=o.Boolean,t.create=r,t.extract=s},function(e,t,i){function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0}),r(i(13)),r(i(5))},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),s=i(1),n=function(e){function t(e){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.id=e,i}return _inherits(t,e),_createClass(t,[{key:"hasField",value:function(e){return r.includes(this.fields,e.id)}},{key:"addField",value:function(e){this.hasField(e)||this.fields.push(e.id)}},{key:"removeField",value:function(e){this.fields=r.without(this.fields,e.id)}},{key:"hasNext",value:function(e){return r.includes(this.nexts,e.id)}},{key:"addNext",value:function(e){this.hasNext(e)||this.nexts.push(e.id)}},{key:"removeNext",value:function(e){this.nexts=r.without(this.nexts,e.id)}},{key:"isTerminal",value:function(){return 0==this.nexts.length}},{key:"serialize",value:function(){return Object.assign({},_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this),{name:this.name,fields:this.fields,nexts:this.nexts})}},{key:"deserialize",value:function(e){return _get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deserialize",this).call(this,e),r.isObject(e)&&(this.name=e.name,this.fields=e.fields,this.nexts=e.nexts),this}}]),t}(s.ValidableObject);t.State=n},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),s=function(e){function t(e){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.id=e,i}return _inherits(t,e),_createClass(t,[{key:"serialize",value:function(){return Object.assign({},_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this),{html:this.html})}},{key:"deserialize",value:function(e){return _get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deserialize",this).call(this,e),this.html=e.html,this}}]),t}(r.ValidableObject);t.Section=s},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"equal",value:function(e){return e.id==this.id}},{key:"serialize",value:function(){return{id:this.id,name:this.name,picture:this.picture}}},{key:"deserialize",value:function(e){return this.id=e.id,this.name=e.name,this.picture=e.picture,this}}]),e}();t.User=r},function(e,t,i){function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0}),r(i(3)),r(i(4)),r(i(10)),r(i(12)),r(i(6))},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i(7))},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),s=function(){function e(){_classCallCheck(this,e),this.display=new Array}return _createClass(e,[{key:"displayIndex",value:function(e){return this.display.findIndex(function(t){return t==e.id})}},{key:"displayHas",value:function(e){return this.displayIndex({id:e})!=-1}},{key:"displayCanMoveDown",value:function(e){return e.id!=r.last(this.display)}},{key:"displayCanMoveUp",value:function(e){return e.id!=r.head(this.display)}}]),e}();t.DisplayableContainer=s;!function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}_inherits(t,e),_createClass(t,[{key:"displayMoveUp",value:function(e){if(this.displayCanMoveUp(e)){var t=this.displayIndex(e),i=this.display[t];this.display[t]=this.display[t-1],this.display[t-1]=i}}},{key:"displayMoveDown",value:function(e){if(this.displayCanMoveDown(e)){var t=this.displayIndex(e),i=this.display[t];this.display[t]=this.display[t+1],this.display[t+1]=i}}},{key:"displayRemove",value:function(e){var t=this.displayIndex(e);this.display.splice(t,1)}}]),t}(s)},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),s=i(2),n=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"type",value:function(){return"boolean"}},{key:"serialize",value:function(){var e=_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this);return r.isEmpty(this.label)||(e.label=this.label),r.isEmpty(this.default)||(e.default=this.default),e}},{key:"deserialize",value:function(e){return _get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deserialize",this).call(this,e),r.isEmpty(this.label)||(this.label=e.label),r.isEmpty(this.default)||(this.default=e.default),this}}]),t}(s.Field);t.Boolean=n},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),s=i(1),n=i(7),a=i(6),o=i(3),l=i(4),u=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.url="",e.proto=2,e.version=0,e.states=!1,e.name="",e.description="",e.fields=new Map,e.sections=new Map,e.display=new Array,e}return _inherits(t,e),_createClass(t,[{key:"isEmpty",value:function(){return 0==this.fields.size}},{key:"isNew",value:function(){return 0==this.version}},{key:"hasField",value:function(e){return this.fields.has(e)}},{key:"getField",value:function(e){return this.fields.get(e)}},{key:"getSection",value:function(e){return this.sections.get(e)}},{key:"displayIndex",value:function(e){return this.display.findIndex(function(t){return t==e.id})}},{key:"displayCanMoveDown",value:function(e){return e.id!=r.last(this.display)}},{key:"displayCanMoveUp",value:function(e){return e.id!=r.head(this.display)}},{key:"serialize",value:function(){var e={};this.fields.forEach(function(t,i){return e[""+i]=t.serialize()});var i={};return this.sections.forEach(function(e,t){return i[""+t]=e.serialize()}),Object.assign({},_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this),{url:this.url,owner:this.owner.serialize(),created:this.created.toJSON(),updated:this.updated.toJSON(),proto:this.proto,version:this.version,states:this.states,name:this.name,description:this.description,fields:e,sections:i,display:this.display,fsm:this.fsm.serialize()})}},{key:"deserialize",value:function(e){var i=this;return _get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deserialize",this).call(this,e),r.isEmpty(e)?this:(this.url=e.url,r.isObject(e.owner)&&(this.owner=(new n.User).deserialize(e.owner)),r.isEmpty("created")||(this.created=new Date(e.created)),r.isEmpty("updated")||(this.updated=new Date(e.updated)),this.proto=e.proto,this.version=e.version,this.states=e.states,this.name=e.name,this.description=e.description,this.fields=new Map,r.each(e.fields,function(e,t){var s=r.toSafeInteger(t);i.fields.set(s,o.extract(s,e))}),this.sections=new Map,r.each(e.sections,function(e,t){var s=r.toSafeInteger(t);i.sections.set(s,new a.Section(s).deserialize(e))}),this.display=r.map(e.display,r.toSafeInteger),r.isObject(e.fsm)&&(this.fsm=(new l.FSM).deserialize(e.fsm)),this)}}]),t}(s.ValidableObject);t.Form=u},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),s=i(1),n=i(5),a=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"has",value:function(e){return this.states.has(e)}},{key:"length",value:function(){return this.states.size}},{key:"get",value:function(e){return this.states.get(e)}},{key:"all",value:function(){return this.states.values()}},{key:"add",value:function(e){this.has(e.id)||this.states.set(e.id,e)}},{key:"remove",value:function(e){this.states.delete(e.id)}},{key:"hasField",value:function(e){var t=!0,i=!1,r=void 0;try{for(var s,n=this.states.values()[Symbol.iterator]();!(t=(s=n.next()).done);t=!0){if(s.value.hasField(e))return!0}}catch(e){i=!0,r=e}finally{try{!t&&n.return&&n.return()}finally{if(i)throw r}}return!1}},{key:"addField",value:function(e){this.states.forEach(function(t){return t.addField(e)})}},{key:"removeField",value:function(e){this.states.forEach(function(t){return t.removeField(e)})}},{key:"statesFor",value:function(e){var t=new Array,i=!0,r=!1,s=void 0;try{for(var n,a=this.states.values()[Symbol.iterator]();!(i=(n=a.next()).done);i=!0){var o=n.value;o.hasField(e)&&t.push(o)}}catch(e){r=!0,s=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw s}}return t}},{key:"hasChildErrors",value:function(){var e=!0,t=!1,i=void 0;try{for(var r,s=this.states.values()[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){if(r.value.hasErrors())return!0}}catch(e){t=!0,i=e}finally{try{!e&&s.return&&s.return()}finally{if(t)throw i}}return!1}},{key:"setErrors",value:function(e){var i=this;if(_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setErrors",this).call(this,e),r.has(e,"states.items")){var s=e.states.items;r.each(s,function(e,t){var s=r.toSafeInteger(t);i.has(s)&&i.get(s).setErrors(e)})}}},{key:"serialize",value:function(){var e={};return this.states.forEach(function(t,i){return e[""+i]=t.serialize()}),Object.assign({},_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"serialize",this).call(this),{initial:this.initial.id,states:e})}},{key:"deserialize",value:function(e){var i=this;return _get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deserialize",this).call(this,e),this.states=new Map,r.isObject(e.states)&&(r.each(e.states,function(e,t){var s=r.toSafeInteger(t);i.states.set(s,new n.State(s).deserialize(e))}),this.initial=this.states.get(r.toSafeInteger(e.initial))),this}}]),t}(s.ValidableObject);t.FSM=a},function(e,t,i){function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0}),r(i(8)),r(i(1)),r(i(9))},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),s=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"serialize",value:function(){return{code:this.code,data:this.data}}},{key:"deserialize",value:function(e){return this.code=e.code,this.data=e.data,this}}]),e}();t.ValidationError=s;var n=function(){function e(){_classCallCheck(this,e),this.errors=new Array}return _createClass(e,[{key:"hasErrors",value:function(){return this.errors.length>0}},{key:"setErrors",value:function(e){this._extract(e)}},{key:"first",value:function(){if(this.hasErrors())return this.errors[0]}},{key:"serialize",value:function(){var e=[],t=!0,i=!1,r=void 0;try{for(var s,n=this.errors[Symbol.iterator]();!(t=(s=n.next()).done);t=!0){var a=s.value;e.push(a.serialize())}}catch(e){i=!0,r=e}finally{try{!t&&n.return&&n.return()}finally{if(i)throw r}}return e}},{key:"deserialize",value:function(e){return this._extract(e)}},{key:"_extract",value:function(e){var t=this;return this.errors=new Array,r.isArray(e)&&r.each(e,function(e){return t.errors.push((new s).deserialize(e))}),this}}]),e}();t.ValidationList=n;var a=function(){function e(){_classCallCheck(this,e),this.errors=new Map}return _createClass(e,[{key:"hasErrors",value:function(){return this.errors.size>0}},{key:"hasChildErrors",value:function(){return!1}},{key:"setErrors",value:function(e){this._extract(e)}},{key:"serialize",value:function(){var e={};return this.errors.forEach(function(t,i){return e[""+i]=t.serialize()}),r.isEmpty(e)?{}:{errors:e}}},{key:"deserialize",value:function(e){return this._extract(e.errors)}},{key:"_extract",value:function(e){var t=this;return this.errors=new Map,r.isObject(e)&&r.each(e,function(e,i){var s=(r.toSafeInteger(i),(new n).deserialize(e));s.hasErrors()&&t.errors.set(i,s)}),this}}]),e}();t.ValidableObject=a}]);